---
title: "country's income by temperature"
output: pdf_document
---

```{r, echo=FALSE, include=FALSE}
library(tidyverse)
library(knitr)
opts_chunk$set(warning = FALSE, message = FALSE)
```

```{r}
income <- read_csv('wid_data.csv')
income <- income %>%
  rename(
    avg_income = `National Income Total Population`)

temperature <- read_csv('table-1.csv')
temperature <- temperature %>% 
  rename(
    temp = `Average yearly temperature (1961â€“1990 Celsius)`
  )

```

```{r}
# left merge
temperature_income <- merge(x = income, y = temperature, by = "Country")
```

```{r}
temperature_income$temp <- as.numeric(temperature_income$temp)
```

```{r}
temperature_income %>% ggplot(aes(x = temp, y = avg_income)) +
  geom_point(alpha = 0.5) + 
  geom_smooth(method = 'lm', se = FALSE) +
  theme_classic()
```

```{r}
model1 <- lm(avg_income ~ temp, data = temperature_income)
summary(model1)$coefficients
cor(x = temperature_income$temp, y = temperature_income$avg_income)
summary(model1)$r.squared
```